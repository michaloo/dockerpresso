#!/usr/bin/env sh
set -e

SCRIPT_PATH=$(dirname "$0")
BASE_PATH=$1
INSTALLATION_PATH=$2
CURRENT_VERSION=$(sh $SCRIPT_PATH/../templates/dockerpresso version)


echo "Installing Dockerpresso ($CURRENT_VERSION)";

if [ -f $BASE_PATH/$INSTALLATION_PATH/dockerpresso ] ; then
    INSTALLED_VERSION=$(sh $BASE_PATH/$INSTALLATION_PATH/dockerpresso version)
    if [ "$CURRENT_VERSION" != "$INSTALLED_VERSION" ] ; then
        echo "Found different version of Dockerpresso: $INSTALLED_VERSION. To update remove dockerpresso file and re-run this script."
        exit 2
    fi
    echo "Dockerpresso is installed in the latest version" >&2
    exit 2
fi

cp -iav $SCRIPT_PATH/../templates/. $BASE_PATH/$INSTALLATION_PATH

echo "Remember to add wordpress_data to .gitignore"

exit 0
